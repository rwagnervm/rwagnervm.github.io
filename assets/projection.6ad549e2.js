import{hi as d,hq as _,hK as $,hL as j,a$ as R,hM as x,he as v,hN as O,co as W,hn as b,hO as q,hJ as z,hP as B,hQ as J,hR as K,K as S,hp as Y,hS as Q,z as U}from"./index.7eb0daf2.js";import{e as D}from"./mat3f64.4564d6a3.js";import{o as N,e as H}from"./mat4f64.a89cc140.js";import{a as g}from"./spatialReferenceEllipsoidUtils.54dfd023.js";import{u as L}from"./computeTranslationToOriginAndRotation.4860e3ef.js";import{t as V,o as I}from"./DoubleArray.2bb33e3e.js";import{i as A,T as F}from"./BufferView.80717d85.js";import{f as X,l as G,e as k}from"./vec3.5fc4e8fc.js";import{n as Z}from"./vec4.2d53fcda.js";import"./vec42.faaf2b1c.js";const pr="Projection may be possible after calling projection.load().";function Tr(r,t,o,a){r.error(`Failed to project from (wkid:${t.wkid}) to (wkid:${o.wkid}).${a?" ":""}${a}`)}function Pr(r,t,o,a,e){return C(h.TO_PCPF,A.fromTypedArray(r),u.NORMAL,F.fromTypedArray(t),F.fromTypedArray(o),a,A.fromTypedArray(e))?e:null}function yr(r,t,o,a,e){return C(h.FROM_PCPF,A.fromTypedArray(r),u.NORMAL,F.fromTypedArray(t),F.fromTypedArray(o),a,A.fromTypedArray(e))?e:null}function hr(r,t,o){return d(r,t,0,o,g(t),0,r.length/3)?o:null}function Ar(r,t,o){return d(r,g(o),0,t,o,0,r.length/3)?t:null}function Fr(r,t,o){return _(f,o),X(t,r,f),$(f)&&G(t,t),t}function Nr(r,t,o){return j(f,o),Z(t,r,f),$(f)&&G(t,t,4),t}function Mr(r,t,o,a){const e=t===u.NORMAL;return w(r,t,o,(i,l)=>{const n=Math.cos(U(i));l[0]=e?n:1/n,l[1]=1},a)}function dr(r,t,o,a){const e=t===u.NORMAL;return w(r,t,o,(i,l)=>{const n=Math.cosh(-i/Q.radius);l[0]=1,l[1]=e?n:1/n},a)}function w(r,t,o,a,e){const i=t===u.NORMAL?3:4,l=[0,0];for(let n=0,m=1;n<r.length;n+=i,m+=3){a(o[m],l);const c=r[n]*l[0],p=r[n+1]*l[1],s=r[n+2],P=1/Math.sqrt(c*c+p*p+s*s);e[n]=c*P,e[n+1]=p*P,e[n+2]=s*P,i===4&&(e[n+3]=r[n+3])}return e}function gr(r,t,o,a,e){if(!C(h.TO_PCPF,A.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),u.TANGENT,F.fromTypedArray(t),F.fromTypedArray(o),a,A.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let i=3;i<r.length;i+=4)e[i]=r[i];return e}function Cr(r,t,o,a,e){if(!C(h.FROM_PCPF,A.fromTypedArray(r,16),u.TANGENT,F.fromTypedArray(t),F.fromTypedArray(o),a,A.fromTypedArray(e,16)))return null;for(let i=3;i<r.length;i+=4)e[i]=r[i];return e}var u,h;function E(r,t,o,a,e){switch(L(a,o,y,a),r===h.FROM_PCPF&&Y(y,y),t){case u.NORMAL:return _(e,y);case u.TANGENT:return j(e,y)}}function C(r,t,o,a,e,i,l){if(!t)return;const n=a.count,m=g(i);if(or(i))for(let c=0;c<n;c++)e.getVec(c,M),t.getVec(c,T),R(T,T,E(r,o,M,m,f)),l.setVec(c,T);else for(let c=0;c<n;c++){e.getVec(c,M),t.getVec(c,T);const p=x(a.get(c,1));let s=Math.cos(p);o===u.TANGENT!=(r===h.TO_PCPF)&&(s=1/s),E(r,o,M,m,f),r===h.TO_PCPF?(f[0]*=s,f[1]*=s,f[2]*=s,f[3]*=s,f[4]*=s,f[5]*=s):(f[0]*=s,f[3]*=s,f[6]*=s,f[1]*=s,f[4]*=s,f[7]*=s),R(T,T,f),v(T,T),l.setVec(c,T)}return l}function Or(r){return r.vertexSpace.type==="local"?rr(r):tr(r)}function rr({vertexSpace:r,transform:t,inSpatialReference:o,outSpatialReference:a,localMode:e,outPositions:i,positions:l}){const n=r.origin??O,m=r.origin!=null?t?.localMatrix??N:N,c=g(o),p=a.isWebMercator&&e||!W(o,c)?o:c;L(o,n,y,p),b(y,y,m);const s=i??V(l.length);return k(s,l,y),d(s,p,0,s,a,0,s.length/3),s}function tr({vertexSpace:r,transform:t,outPositions:o,positions:a,inSpatialReference:e,outSpatialReference:i}){const l=r.origin!=null?t?.localMatrix??N:N,n=o??V(a.length);q(l,N)?I(n,a):k(n,a,l);const m=r.origin??O;if(!z(m,O)){const[c,p,s]=m;for(let P=0;P<n.length;P+=3)n[P]+=c,n[P+1]+=p,n[P+2]+=s}return d(n,e,0,n,i,0,n.length/3)?n:null}function or(r){return r.isWGS84||B(r)||J(r)||K(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(u||(u={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(h||(h={}));const M=S(),T=S(),y=H(),f=D();export{u as VectorType,pr as loadProjectErrorMessage,Tr as logProjectionError,Or as project,Ar as projectFromPCPF,yr as projectNormalFromPCPF,Pr as projectNormalToPCPF,Cr as projectTangentFromPCPF,gr as projectTangentToPCPF,hr as projectToPCPF,Fr as transformNormal,Nr as transformTangent,Mr as transformVectorENUPlateCarree,dr as transformVectorWMPlateCarree};
