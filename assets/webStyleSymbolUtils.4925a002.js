import{s as S,cL as w,cI as u,eR as f,eA as N,dM as R,iP as g,iQ as d}from"./index.7eb0daf2.js";import{c as $,a as h}from"./devEnvironmentUtils.307ef2af.js";import{b as D}from"./jsonUtils.185b82ae.js";import{y as x,b as P,p as U,w as A,d as F}from"./styleUtils.7f2b22b0.js";import"./defaults.e5a1167a.js";import"./defaultsJSON.ba72df2f.js";function q(t,e,l,r){const n=t.name;return n==null?Promise.reject(new S("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?C(n,e,r):x(t,e,r).then(o=>v(o,n,e,l,F,r))}function M(t,e){return e.items.find(l=>l.name===t)}function v(t,e,l,r,n,o){const s=l?.portal!=null?l.portal:w.getDefault(),b={portal:s,url:u(t.baseUrl),origin:"portal-item"},m=M(e,t.data);if(!m){const p=`The symbol name '${e}' could not be found`;return Promise.reject(new S("symbolstyleutils:symbol-name-not-found",p,{symbolName:e}))}let i=f(n(m,r),b),y=m.thumbnail?.href??null;const c=m.thumbnail?.imageData;$()&&(i=h(i)??"",y=h(y));const j={portal:s,url:u(N(i)),origin:"portal-item"};return P(i,o).then(p=>{const I=r==="cimRef"?U(p.data):p.data,a=D(I,j);if(a&&R(a)){if(y){const O=f(y,b);a.thumbnail=new g({url:O})}else c&&(a.thumbnail=new g({url:`data:image/png;base64,${c}`}));t.styleUrl?a.styleOrigin=new d({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(a.styleOrigin=new d({portal:l.portal,styleName:t.styleName,name:e}))}return a})}function C(t,e,l){const r=A.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:w.getDefault();return P(r,l).then(o=>{const s=U(o.data);return D(s,{portal:n,url:u(N(r)),origin:"portal-item"})})}export{v as fetchSymbolFromStyle,M as getStyleItemFromStyle,q as resolveWebStyleSymbol};
