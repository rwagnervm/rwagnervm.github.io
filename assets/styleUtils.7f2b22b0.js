import{d as o,s as y,U as d,ez as m,eA as b,cM as p,cL as h,eB as w}from"./index.7eb0daf2.js";const g=()=>!!o("enable-feature:force-wosr"),U=()=>o.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),j=()=>o.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),N=()=>o.add("enable-i3s-patching",!0,!0,!0),R=()=>o.add("enable-i3s-patching",!1,!0,!0),D=()=>!!o("enable-feature:SceneLayer-editing"),$=(e="i3s-patching")=>{switch(R(),j(),o.add("enable-feature:SceneLayer-editing",!0,!0,!0),e){case"feature-layer-view":U();break;case"i3s-patching":N()}};$("i3s-patching");let c={};async function I(e,n){try{return{data:(await C(e,n)).data,baseUrl:b(e),styleUrl:e}}catch(t){return p(t),null}}function S(e,n,t){const r=n.portal!=null?n.portal:h.getDefault();let s;const l=`${r.url} - ${r.user?.username} - ${e}`;return c[l]||(c[l]=A(e,r,t).then(a=>(s=a,a.fetchData())).then(a=>({data:a,baseUrl:s.itemUrl??"",styleName:e}))),c[l]}function A(e,n,t){return n.load(t).then(()=>{const r=new w({disableExtraQuery:!0,query:`owner:${i} AND type:${u} AND typekeywords:"${e}"`});return n.queryItems(r,t)}).then(({results:r})=>{let s=null;const l=e.toLowerCase();if(r&&Array.isArray(r)){for(const a of r)if(a.typeKeywords?.some(f=>f.toLowerCase()===l)&&a.type===u&&a.owner===i){s=a;break}}if(!s)throw new y("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return s.load(t)})}function k(e,n,t){return e?.styleUrl!=null?I(e.styleUrl,t):e?.styleName!=null?S(e.styleName,n,t):Promise.reject(new y("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function M(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function v(e,n,t=["gltf"]){if(n==="cimRef")return encodeURI(e.cimRef);if(e.formatInfos&&!g())for(const r of t){const s=e.formatInfos.find(l=>l.type===r);if(s)return s.href}return encodeURI(e.webRef)}function C(e,n){const t={responseType:"json",query:{f:"json"},...n};return d(m(e),t)}const i="esri_en",u="Style",x="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{C as b,v as d,D as n,M as p,x as w,k as y};
